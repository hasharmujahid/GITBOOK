# EXPLOITING OS COMMAND INJECTION VULNERABILITIES

<figure><img src="https://miro.medium.com/max/1400/0*fsDcLw9CU5hxtTs-.webp" alt=""><figcaption></figcaption></figure>



### What is OS Command Injection? <a href="#29c5" id="29c5"></a>

An OS command injection is a vulnerability that allows an attacker to execute arbitrary commands directly on the server. If you haven't already realized, if an attacker is able to execute malicious code on the server, he could easily get a reverse shell or a backdoor into the server.

So finding Os command injection during bug-bounty and penetration is marked as a critical vulnerability.

### Example: <a href="#2ce1" id="2ce1"></a>

Like in this simple lab, instead of only whitelisted commands server allows the user to execute all commands.

### Use Full Commands: <a href="#7581" id="7581"></a>

An attacker can run some commands to get related information to the user and the targetâ€™s operating system.

> Name of the current user
>
> `whoami`
>
> Operating&#x20;
>
> system`uname -a`
>
> Network configuration
>
> `ifconfig`
>
> Network connections
>
> `netstat -an`
>
> Running processes
>
> `ps -ef`

### OS Command Injections In Post Request Parameters: <a href="#887d" id="887d"></a>

We can see in this lab that the post request is made when we enter the value.

We can determine that because in the GET request the parameter is listed in the URL and in the POST request the parameter is not listed in the URL.

```
GET http://124.221.152.247:5001/CMD-1/index.php?cmd=ls
POSThttp://124.221.152.247:5001/CMD-1/index.php
```

Now the question is

### How To Detect Command Injection Vulnerability: <a href="#c886" id="c886"></a>

There is no specific answer to this question. try to understand the logic of the application if there is suspected suspicion that some functionality is using vulnerable functions like

> eval()
>
> system()
>
> passthru()

You can try to inject commands and test those parameters.

### Breaking Out Of Existing Commands: <a href="#483f" id="483f"></a>

Sometimes, if the code execution is very important in the exposed functionality, applications set a pre-made path of the command and get the query from the user.

Now to get command execution, we need to use some bypassing techniques so we can execute code.

We can use `;` symbol to end the execution of one command and add ours.

We can see our code executed.

\


